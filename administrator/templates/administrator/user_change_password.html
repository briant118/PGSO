{% extends 'base.html' %}

{% block title %}Change password – {{ target_user.username }} – PGSO{% endblock %}

{% block content %}
<style>
.page-header { margin-bottom: 2rem; }
.page-title { margin: 0 0 0.5rem; font-size: 2rem; color: #1a1d24; font-weight: 700; display: flex; align-items: center; gap: 0.75rem; }
.page-subtitle { margin: 0; color: #5f6368; font-size: 0.95rem; }
.card-container { background: #fff; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); overflow: hidden; max-width: 520px; }
.card-header { padding: 1.5rem; border-bottom: 1px solid #e8eaed; }
.card-header h2 { margin: 0; font-size: 1.25rem; color: #1a1d24; }
.form-body { padding: 1.5rem; }
.form-group { margin-bottom: 1.25rem; }
.form-group label { display: block; font-weight: 600; color: #1a1d24; margin-bottom: 0.4rem; font-size: 0.95rem; }
.form-group input[type="password"], .form-group input[type="email"], .form-group input[type="text"] { width: 100%; max-width: 320px; padding: 0.6rem 0.75rem; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; }
.form-group .hint { font-size: 0.85rem; color: #5f6368; margin-top: 0.35rem; }
.form-actions { padding: 1rem 1.5rem; border-top: 1px solid #e8eaed; display: flex; gap: 0.75rem; }
.btn { padding: 0.6rem 1.25rem; border-radius: 8px; font-size: 0.95rem; font-weight: 600; cursor: pointer; text-decoration: none; border: none; display: inline-flex; align-items: center; gap: 0.5rem; }
.btn-primary { background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%); color: #fff; }
.btn-secondary { background: #e8eaed; color: #1a1d24; }
</style>

<div class="page-header">
  <div>
    <h1 class="page-title"><i class="fas fa-key" style="color: #4299e1;"></i> Change password</h1>
    <p class="page-subtitle">User: <strong>{{ target_user.username }}</strong>{% if target_user.get_full_name %} ({{ target_user.get_full_name }}){% endif %}</p>
  </div>
  <a href="{% url 'administrator:user_accounts' %}" class="btn btn-secondary">Back to User Accounts</a>
</div>

<div class="card-container">
  <div class="card-header"><h2>Set new password</h2></div>
  <form method="post" action="{% url 'administrator:user_change_password' target_user.pk %}">
    {% csrf_token %}
    <div class="form-body">
      {% if is_fixed_admin %}
      <div class="form-group">
        <label for="id_confirm_email">Confirm admin email <span style="color:#dc3545;">*</span></label>
        <input type="email" name="confirm_email" id="id_confirm_email" required placeholder="Enter the admin account email" value="{{ target_user.email|default:'' }}">
        <div class="hint">The fixed admin account requires email verification. Enter the email for {{ target_user.username }}.</div>
      </div>
      {% endif %}
      <div class="form-group">
        <label for="id_new_password">New password <span style="color:#dc3545;">*</span></label>
        <input type="password" name="new_password" id="id_new_password" required placeholder="At least 8 characters" autocomplete="new-password">
      </div>
      <div class="form-group">
        <label for="id_new_password_confirm">Confirm new password <span style="color:#dc3545;">*</span></label>
        <input type="password" name="new_password_confirm" id="id_new_password_confirm" required placeholder="Re-enter password" autocomplete="new-password">
      </div>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Change password</button>
      <a href="{% url 'administrator:user_accounts' %}" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
